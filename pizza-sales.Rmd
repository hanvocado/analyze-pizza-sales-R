---
title: "pizza-sales"
author: "Nguyen Thi Ngoc Han"
date: "2024-11-04"
output: html_document
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readxl)
library(ggplot2)
library(arules)
library(arulesViz)
library(car)
library(randomForest)
```

# Phần 1. Tóm tắt:

# Phần 2. Giới thiệu:

# Phần 3. Mục tiêu phân tích:

# Phần 4. Thông tin về tập dữ liệu:

```{r}
sales_df <- read_excel("./data/Pizza Sales.xlsx")

head(sales_df)
```
```{r}
str(sales_df)
```
# Phần 5. Tiền xử lý dữ liệu:

Sao chép dữ liệu vào biến df để xử lý trên bản sao không gây ảnh hưởng đến dữ liệu gốc.
```{r}
df <- sales_df
```

## 5.1. Kiểm tra giá trị thiếu (na) và trùng lặp (duplicate)
* Kiểm tra xem có tồn tại giá trị thiếu (na) ở các cột hay không
```{r}
colSums(is.na(df))
```
Không tồn tại giá trị na.

* Kiểm tra xem có tồn tại duplicate hay không
```{r}
any(duplicated(df))
```
Không có quan sát nào bị trùng lặp

## 5.2. Chuyển đổi cột pizza_size, pizza_category thành factor

Xem các giá trị duy nhất của cột pizza_size và pizza_category để xác định thành phần trong levels của factor
```{r}
unique(df$pizza_size)
unique(df$pizza_category)
```
Thực hiện chuyển đổi thành factor
```{r}
df$pizza_size <- factor(df$pizza_size, levels = c("S", "M", "L", "XL", "XXL"))
df$pizza_category <- factor(df$pizza_category)
```

## 5.3. Tạo cột order_hour

Dữ liệu của cột order_time là kiểu POSIXct, được lưu trữ dưới dạng số thực đơn vị giây tính từ ngày 1 tháng 1 năm 1970, 00:00:00 UTC, và hiển thị dưới dạng yyyy-mm-dd HH:mm:ss. Nhằm phục vụ mục đích phân tích, em sẽ dựa vào cột này để tạo cột order_hour thể hiện giờ đặt bánh của khách.
```{r}
temp_time <- format(df$order_time, "%H:%M:%S")
df <- df %>% mutate(order_hour = sub("(..):..:..", "\\1", temp_time))

head(df)
```

## 5.4. Tạo cột order_weekday

Thêm cột mới tên order_weekday có kiểu factor cho biết khách hàng đã đặt đơn vào thứ mấy.
```{r}
df <- mutate(df, order_weekday = weekdays(order_date))
df$order_weekday <- factor(df$order_weekday, levels = c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"))

head(df)
```

## 5.4. Tạo cột order_month
Thêm cột mới tên order_month có kiểu factor cho biết khách hàng đã đặt đơn vào tháng nào.

```{r}
df <- mutate(df, order_month = format(order_date, "%B"))

df$order_month <- factor(df$order_month, levels = c("January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"))

head(df)
```

## 5.5. Tạo data frame chứa dữ liệu của từng đơn đặt hàng
```{r}
by_order_df <- df %>% group_by(order_id) %>% 
  summarise(quantity = sum(quantity), order_date = order_date[1], total_price = sum(total_price), order_hour = order_hour[1], order_weekday = order_weekday[1], order_month = order_month[1]) %>% ungroup()

head(by_order_df)
``` 

# Phần 6. Phân tích dữ liệu:

## 6.1. Phân tích tổng quan:

```{r}
by_order_df %>% count()
```
```{r}
by_order_df %>% summarise(no_pizzas = sum(quantity), total_revenue = sum(total_price))
```
Trong năm 2015, cửa hàng có 21350 đơn đặt hàng, bán ra tổng 49574 chiến bánh pizza với tổng doanh thu là 817860 USD. 

```{r}
by_order_df %>% select(quantity, total_price) %>% summary()
```
Giá trị đơn hàng nhỏ nhất là 9.75$, lớn nhất là 444.40$. Trung bình, một đơn đặt hàng trị giá 32.5$ và mua 2.322 chiếc bánh pizza.

## 6.2. Phân tích nhu cầu tiêu thụ pizza theo thời gian:

Biểu đồ nhu cầu tiêu thụ pizza theo giờ
```{r}
ggplot(data = df, aes(x = order_hour, y = quantity)) +
  geom_col(fill = "blue") +  
  theme_minimal() +
  labs(x = "Hour", y = "Frequency", title = "Pizza Consumption Demand by Hour") +
  theme(plot.title = element_text(hjust = 0.5)
  )
```
Biểu đồ cho thấy sự phân bố số lượng đơn đặt hàng theo từng giờ trong ngày

Giờ có lượng đơn hàng cao nhất là từ 12h đến 13h trưa. Thời gian từ 17h đến 18h cũng có lượng đơn hàng khá cao. Hai khoảng giờ cao điểm này có thể là các thời điểm mà người tiêu dùng có nhiều thời gian rảnh sau giờ làm việc cho bữa ăn trưa và ăn tối. Các khung giờ khác có số lượng đơn hàng giảm dần và thấp nhất là vào khoảng 9h,10h sáng và 23h khuya.

Dựa vào biểu đồ này, ta có thể quan sát rõ hành vi của người tiêu dùng. Giờ trưa và giờ tan làm có thể là lúc người tiêu dùng có thời gian và nhu cầu đặt thức ăn nhiều hơn. Điều này giúp nhà hàng lập kế hoạch hỗ trợ và chiến lược quảng cáo tốt hơn để thu hút và giữ chân khách hàng.

```{r}
ggplot(data = df, aes(x = order_weekday, y = quantity)) +
  geom_col(fill = "blue") + 
  theme_minimal() +
  labs(x = "Date", y = "Frequency", title = "Pizza Consumption Demand by Day") +
  theme(plot.title = element_text(hjust = 0.5)
  )
```
- Thứ Sáu có nhu cầu cao nhất. Điều này cho thấy mọi người có xu hướng đặt pizza nhiều hơn khi cuối tuần đến gần. Còn lại các ngày khác trong tuần, từ Thứ Hai đến Thứ Năm, nhu cầu tương đối ổn định cho thấy sự tiêu thụ pizza đều đặn trong suốt các ngày làm việc.Nhu cầu thấp nhất vào Chủ Nhật, có khả năng cao khách hàng chuẩn bị cho tuần làm việc sắp tới.
- Biểu đồ cho thấy nhu cầu tiêu thụ pizza tăng cao vào cuối tuần, đạt đỉnh vào Thứ Sáu, có thể do các buổi tụ họp xã hội hoặc xu hướng ăn uống ngoài khi bắt đầu cuối tuần. 

```{r}
ggplot(data = df, aes(x = order_month, y = quantity)) +
  geom_col(fill = "blue") +  
  theme_minimal() +
  labs(x = "Months", y = "Frequency", title = "Pizza Consumption Demand by Month") +
  theme(axis.text.x = element_text(angle = 90, hjust = 1) ,
        plot.title = element_text(hjust = 0.5))  
```
- Các tháng có nhu cầu cao nhất là Tháng Bảy và Tháng Mười Một, cho thấy những khoảng thời gian này có thể có các sự kiện đặc biệt hoặc kỳ nghỉ lễ khiến nhu cầu tăng lên.
- Tháng Hai và Tháng Chín có nhu cầu tiêu thụ pizza thấp hơn so với các tháng khác, có thể do đây là khoảng thời gian sau các kỳ nghỉ lễ hoặc đầu mùa học tập và làm việc.
- Nhìn chung, mức tiêu thụ pizza trong các tháng khá đồng đều, chỉ có sự chênh lệch nhẹ giữa các tháng. Điều này cho thấy pizza là món ăn được ưa chuộng quanh năm, bất kể mùa hay thời điểm.
- Nhu cầu tiêu thụ pizza dường như ổn định trong suốt cả năm, với một số tháng có nhu cầu cao hơn, đặc biệt là vào mùa hè (Tháng Bảy) và vào mùa lễ (Tháng Mười Một). Sự tăng giảm nhẹ giữa các tháng có thể phản ánh sự thay đổi trong thói quen ăn uống của người tiêu dùng theo mùa và các dịp lễ.


```{r fig.width=10, fig.height=5}
ggplot(by_order_df, aes(x = order_month, fill = order_weekday)) +
  geom_bar(position = "dodge", color = "black") +  
  scale_fill_brewer(palette = "Pastel1") +         
  theme_minimal() +
  labs(x = "Months", y = "Frequency", title = "Pizza Consumption Demand by Day of the Week for Each Month") + 
  theme(axis.text.x = element_text(angle = 90, hjust = 1) ,
        plot.title = element_text(hjust = 0.5)) 
```
- Sự phổ biến vào cuối tuần: Trong hầu hết các tháng, Thứ Sáu và Thứ Bảy có xu hướng có tần suất đặt hàng cao hơn, cho thấy nhu cầu tiêu thụ pizza tăng vào cuối tuần, có thể do đây là thời điểm mọi người có thời gian rảnh rỗi hoặc tổ chức các buổi tụ họp.
- Biến động theo tháng: Tháng Năm, Tháng Bảy, và Tháng Mười có một số ngày có tần suất cao hơn rõ rệt (đặc biệt vào các ngày cuối tuần), có thể do những tháng này có các sự kiện, kỳ nghỉ hoặc thời tiết thuận lợi cho các hoạt động ăn uống ngoài trời.
- Nhu cầu ổn định giữa tuần: Nhu cầu tiêu thụ pizza vào các ngày giữa tuần (Thứ Hai đến Thứ Năm) ổn định hơn, với ít biến động giữa các tháng. Điều này cho thấy pizza vẫn được tiêu thụ đều đặn nhưng không quá cao vào những ngày đầu tuần và giữa tuần.
- Chênh lệch theo ngày: Sự khác biệt về tần suất giữa các ngày trong tuần lớn nhất vào những tháng mùa hè và mùa thu, cho thấy nhu cầu có thể bị ảnh hưởng bởi mùa hoặc các kỳ nghỉ kéo dài.
- Ta có thể kết luận rằng nhu cầu tiêu thụ pizza thay đổi theo cả tháng và ngày trong tuần, với xu hướng tiêu thụ cao vào các ngày bắt đầu cuối tuần và một số tháng cụ thể có kì nghỉ lễ hoặc thời tiết đẹp. Điều này có thể được sử dụng để dự đoán nhu cầu và tối ưu hóa nguồn cung cho các khoảng thời gian cao điểm trong năm.

```{r}
ggplot(data = by_order_df, aes(x = order_weekday, y = order_hour, color = order_weekday)) +
  geom_jitter(width = 0.2, height = 0) + # Tạo độ nhiễu ngang để các điểm không bị chồng lên nhau 
  theme_minimal() +
  labs(x = "Order Dates", y = "Hour", title = "Pizza Consumption Demand by Hour of the Dates") +
  theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5)
  )
```
- Các đơn đặt hàng tập trung chủ yếu vào khoảng từ trưa (11 giờ) đến tối (22 giờ), biểu hiện khoảng thời gian từ trưa đến tối là thời gian cao điểm cho nhu cầu tiêu thụ pizza, đặc biệt vào Thứ Sáu và Thứ Bảy. Ngoài khung giờ này là các điểm dữ liệu ngoài (outliers) cho các đơn hàng vào sáng sớm hoặc đêm muộn. Điều này cho thấy có một số ít đơn đặt hàng trong khoảng thời gian ngoài giờ cao điểm.
- Có thể thấy ít có sự biến động giữa các ngày trong tuần và xu hướng chung là tiêu thụ pizza ổn định từ buổi trưa đến tối. Không có ngày nào có sự biến động lớn hoặc bất thường. Nhu cầu khá ổn định trong cả tuần nhưng có xu hướng cao hơn vào Thứ Sáu và Thứ Bảy

```{r, fig.width=10, fig.height=5}
df_table <- table(by_order_df$order_hour, by_order_df$order_weekday)
df_freq <- as.data.frame(df_table)
colnames(df_freq) <- c("Hour", "Day", "Frequency")


ggplot(df_freq, aes(x = Hour, y = Frequency, fill = Day)) +
  geom_bar(stat = "identity", position = position_dodge(width = 0.8))  + 
  scale_fill_manual(values = c("blue", "red", "green", "yellow", "magenta", "cyan", "purple", "orange")) +
  theme_minimal() +
  labs(title = "Pizza Consumption Frequency by Hour of the Day", x = "Hour", y = "Frequency") +
  theme(
    plot.title = element_text(hjust = 0.5),  
    legend.title = element_blank()           
  ) +
  theme(legend.position = "right") +         
  theme(plot.margin = unit(c(1,1,1,1), "cm")) + 
  scale_x_discrete(expand = expansion(mult = c(0.1, 0.1))) 
```
- Thời gian cao điểm: Các giờ cao điểm tiêu thụ pizza tập trung vào buổi trưa (11 giờ - 13 giờ) và buổi tối (17 giờ - 19 giờ). Đỉnh cao nhất của nhu cầu là vào khoảng 12 giờ trưa, với tần suất đặt hàng cao nhất vượt qua 900 đơn vào một số ngày trong tuần, đặc biệt vào các ngày Thứ Ba, Thứ Năm, và Thứ Sáu.
- Sự khác biệt theo ngày trong tuần:
Thứ Ba và Thứ Sáu: Có tần suất tiêu thụ pizza cao vào giờ trưa (11 giờ - 13 giờ) và buổi tối (17 giờ - 19 giờ).
Thứ Bảy: Tần suất đặt hàng tăng cao vào buổi tối từ 17 giờ đến 19 giờ, có thể do đây là ngày cuối tuần.
Chủ Nhật: Tần suất tiêu thụ pizza giảm vào buổi trưa nhưng vẫn có mức độ đặt hàng tương đối ổn định vào buổi tối.
- Thời gian ít đơn đặt hàng: Trong các khoảng thời gian sáng sớm (trước 10 giờ) và đêm muộn (sau 21 giờ), tần suất tiêu thụ pizza khá thấp ở tất cả các ngày. Đặc biệt là từ 22 giờ đến 23 giờ, nhu cầu tiêu thụ pizza gần như không đáng kể.

## 6.3. Phân tích thành phần nguyên liệu:

## 6.4. Phân tích và dự đoán doanh số (sales):

### 6.4.1. Phân tích doanh số bán hàng của từng bánh pizza

* Nhóm dữ liệu theo tên pizza, kích cỡ, và đơn giá để tính doanh số

```{r}
sales_by_pizza <- df %>%
  group_by(pizza_name) %>% 
  summarise(total_sales = sum(quantity))

sprintf("Số bánh pizza cửa hàng kinh doanh: %s", length(sales_by_pizza$pizza_name))
```
* Trực quan hóa doanh số của từng bánh pizza

```{r}
sales_by_pizza %>%
  ggplot(aes(x = total_sales, y = reorder(pizza_name, total_sales))) +
  geom_col(color = "pink", fill = "pink", width = 0.5) +
  labs(title = "Doanh số bán hàng",
       x = "Số lượng",
       y = "Pizza") +
  theme_minimal()
```
+) Pizza bán chạy nhất là The Classic Deluxe Pizza với 2453 bánh.
+) Pizza bán chậm nhất là The Brie Carre Pizza với 490 bánh. Ta có thể dễ dàng nhận thấy sự chênh lệch rất lớn giữa doanh số của nó với các bánh khác, trong đó, chỉ bằng khoảng 50% doanh số của pizza bán chậm thứ hai (The Mediterranean Pizza) và bằng khoảng 20% doanh số của bánh bán chạy nhất.

* Xem các thuộc tính của hai bánh này để dự đoán nguyên nhân gây ra sự chênh lệch lớn 

```{r}
df %>% select(pizza_name, pizza_size, unit_price, pizza_category, pizza_ingredients) %>% 
  group_by(pizza_name) %>% filter(pizza_name == 'The Classic Deluxe Pizza' | pizza_name == 'The Brie Carre Pizza' | pizza_name == 'The Mediterranean Pizza') %>% unique()
```
Có thể nhận thấy sự chênh lệch rất lớn, gần gấp đôi trong giá của The Brie Carre Pizza size S (23.65 USD) và The Classic Deluxe Pizza hay The Mediterranean Pizza size S (12 USD). Do đó em cho rằng biến unit_price và pizza_size có ảnh hưởng tới doanh số, hơn thế nữa hai biến này là hai biến tương tác. Bên cạnh đó, sự khác biệt trong doanh số giữa The Classic Deluxe Pizza và The Mediterranean Pizza mặc dù chúng có mức giá gần như giống hệt nhau cho các kích cỡ. Điều này cho thấy pizza_category cũng ảnh hưởng tới doanh số. Biến pizza_ingredients sẽ trực tiếp phản ánh tới pizza_cateogry nên em bỏ qua nó.
Ngoài ra, The Brie Carre Pizza chỉ có một kích cỡ trong khi đa số bánh còn lại có nhiều kích cỡ, em nghi ngờ độ đa dạng của một bánh pizza ảnh hưởng tới doanh số của nó. Trực quan hóa để kiểm tra:

```{r}
df %>% select(pizza_name, pizza_size) %>% unique() %>% 
  group_by(pizza_name) %>% summarise(no_variants = n()) %>% 
  merge(sales_by_pizza) %>% ggplot(aes(x = no_variants, y = total_sales)) + geom_point()
```
Không có mối quan hệ tương quan giữa no_variants và total_sales, nghĩa là độ đa dạng của một bánh pizza không ảnh hưởng tới doanh số của nó.

### 6.4.2. Phân tích doanh số theo kích cỡ bánh

* Tổng hợp dữ liệu tính doanh số mỗi tháng của từng loại pizza
```{r}
sales_by_size <- df %>%
  group_by(pizza_size, order_month) %>%
  summarise(
    total_sales = sum(quantity)
  )

head(sales_by_size)
```
* Trực quan hóa bảng số liệu trên bằng biểu đồ tròn
```{r}
ggplot(sales_by_size, aes(x = "", y = total_sales, fill = pizza_size)) +
  geom_bar(stat = "identity") +
  coord_polar(theta = "y") +
  labs(title = "Doanh thu theo kích cỡ pizza") +
  theme_void()
```
+) Bánh pizza cỡ L bán chạy nhất với 18956 chiếc bánh chiếm 38% doanh số, theo sau là cỡ M với 15635 bánh (32%) và cỡ S với 14403 bánh (29%).
+) Bánh size XL và XXL có doanh số rất thấp, cả hai chỉ chiếm chưa tới 2% tổng doanh số của năm 2015.

### 6.4.3. Phân tích doanh số theo danh mục bánh

* Tổng hợp dữ liệu theo danh mục bánh
```{r}
sales_by_category <- df %>%
  group_by(pizza_category, order_month) %>%
  summarise(
    total_sales = sum(quantity)
  )

sales_by_category
```

* Trực quan hóa

```{r}
ggplot(sales_by_category, aes(x = pizza_category, y = total_sales, fill = order_month)) +
  geom_col() +
  labs(title = "Doanh số năm 2015 của từng danh mục bánh",
       x = "Danh mục",
       y = "Doanh số",
       fill = "Tháng") +
  theme_minimal()
```
Danh mục bánh Classic bánh chạy nhất với 14888 chiếc. Ba loại còn lại có sự chênh lệch không đáng kể với nhau, cụ thể Supreme là 11987, Veggie là 11649 và thấp nhất là Chicken với 11050 chiếc bánh.
Đối với từng danh mục pizza, doanh số không có sự chênh lệch nào đáng kể giữa các tháng.

### 6.4.4. Dự đoán doanh số bằng mô hình hồi quy tuyến tính

* Trực quan hóa mối quan hệ giữa doanh số và giá cùng với kích cỡ và danh mục bánh.

```{r}
sales_data <- df %>%  group_by(unit_price, pizza_size, pizza_category, order_month) %>% summarise(sales = sum(quantity))

sales_data %>% 
  ggplot(aes(x = unit_price, y = sales, color = pizza_size, shape = pizza_category)) +
  geom_jitter()
```
Biểu đồ cho thấy tác động của giá bán lên sales khác nhau đối với các cỡ bánh khác nhau và các loại bánh khác nhau. Cụ thể như bánh size S giá thấp (~10) có doanh số cao hơn rất nhiều so với bánh size S giá trên 20 USD. Và cùng ở khoảng giá 20 USD nhưng doanh số của các danh mục chênh lệch nhau rất rõ rệt. Vì vậy, ngoài 3 biến độc lập unit_price, pizza_size, pizza_category em sẽ thêm sự tác giữa các biến vào mô hình hồi quy tuyến tính.

```{r}
lm_sales_model <- lm(sales ~ unit_price * (pizza_size + pizza_category), data = sales_data)
summary(lm_sales_model)
```
F-statistic bằng 38.31 với p-value < 2.2e-16, cho thấy rằng mô hình hồi quy này có ý nghĩa thống kê và ít nhất một trong các biến độc lập có ảnh hưởng đáng kể đến doanh số. Cụ thể về ý nghĩa thống kê của từng biến, ngoại trừ pizza_sizeXL pizza_sizeXXL và các biến tương tác liên quan thì các biến độc lập và biến tương tác khác đều có p-value nhỏ, chứng tỏ chúng có ý nghĩa thống kê. Việc các biến giả của cỡ XL và XXL không có ý nghĩa thống kê và hệ số của các biến tương tác liên quan bị thiếu là do có rất ít dữ liệu cho các pizza cỡ XL hay XXL.
Multiple R-squared bằng 0.5443 và Adjusted R-squared bằng 0.5301 cho thấy mô hình giải thích khoảng 54% biến động của biến phụ thuộc. Mặc dù không quá cao, giá trị này vẫn cho thấy mô hình có thể giải thích một phần đáng kể sự biến động doanh số trong tập dữ liệu.
Để dự đoán doanh số chính xác hơn, em sẽ sử dụng mô hình random forest.

### 6.4.4. Dự đoán doanh số bằng Random Forest

Nguyên nhân dùng random forest cho bài toán dự đoán doanh thu này là vì khả năng xử lý các mối quan hệ phức tạp giữa các biến độc lập một cách tự động mà không cần ta phải chỉ định biến tương tác. Cụ thể cho bài toán này, random forest có thể tự động nhận diện nếu có sự tương tác giữa unit_price, pizza_size, pizza_category và phản ánh chúng trong quá trình xây dựng desicion tree.

* Chia tập dữ liệu thành 80% cho huấn luyện và 20% cho kiểm tra.

```{r}
set.seed(123)  
train_index <- sample(nrow(sales_data), 0.8 * nrow(sales_data))
train_data <- sales_data[train_index, ]
test_data <- sales_data[-train_index, ]
```

* Xây dựng mô hình dự đoán doanh số
```{r}
rf_sales_model <- randomForest(sales ~ unit_price + pizza_size + pizza_category, data = train_data)

rf_sales_model
```
Mô hình giải thích được 76% sự biến động của sales. Đây là một tỷ lệ khá cao, cho thấy mô hình đã học tốt từ dữ liệu và có khả năng dự đoán khá chính xác.

* Tối ưu hóa mô hình:

Hiện tại, số cây quyết định của mô hình là 500 và số biến được thử tại mỗi lần phân tách là 1.
- Kiểm tra ngưỡng cây tối ưu chưa:
```{r}
plot(rf_sales_model)
```
Biểu đồ cho thấy số cây này là phù hợp vì error tại 500 đã rất nhỏ và gần như không còn giảm nữa.

- Sử dụng tuneRF để tìm tham số mtry tối ưu cho mô hình:

```{r}
tune_rf <- tuneRF(sales_data[, -which(names(sales_data) == "sales")], sales_data$sales)
```
OOB Error rate là lỗi ngoài bộ dữ liệu huấn luyện, phản ánh độ chính xác của mô hình. Dự vào biểu đồ kết hợp với việc dữ liệu có 3 biến độc lập, mà chúng lại có tương tác phức tạp với nhau nên em chọn mtry = 2 để tối ưu mô hình.

```{r}
rf_sales_model <- randomForest(sales ~ unit_price + pizza_size + pizza_category, data = train_data, mtry = 2)

rf_sales_model
```
* Dự đoán doanh số trên tập dữ liệu kiểm tra

```{r}
predicted_sales <- predict(rf_sales_model, newdata = test_data)

head(predicted_sales)
```
* Kiểm tra độ chính xác

```{r}
actual_values <- test_data$sales

# Tính R2 (R-squared)
ss_total <- sum((actual_values - mean(actual_values))^2)
ss_residual <- sum((actual_values - predicted_sales)^2)
r_squared <- 1 - (ss_residual / ss_total)
cat("R-squared:", r_squared)
```

```{r}
# Tính toán lỗi RMSE (Root Mean Squared Error)
rmse <- sqrt(mean((predicted_sales - actual_values)^2))
cat("RMSE", rmse)
```


# Phần 7. Phân tích và dự đoán doanh thu:

# Phần 8. Kết luận:

# Phần 9. Phụ lục:

# Phần 10. Đóng góp:





